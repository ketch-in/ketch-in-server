<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ketch in!</title>
    <script src="./socket.io.js"></script>
  </head>
  <body>
    <script>
      const SOCKET_EVENT = {
        CONNECT: "connect",
        DISCONNECT: "disconnect",
        CONNECT_ERROR: "connect_error",
        JOIN: "join",
        REFETCH: "organizer-info:refetch",
        UPDATE: "organizer-info:update",
        DRAW: "draw:add",
      };

      socket = io();

      socket.on(SOCKET_EVENT.CONNECT, () => {
        socket.emit(SOCKET_EVENT.JOIN, "123");
      });

      socket.on(SOCKET_EVENT.DISCONNECT, () => {});

      socket.on(SOCKET_EVENT.CONNECT_ERROR, () => {
        draw.uninstall();
      });

      socket.on(SOCKET_EVENT.REFETCH, () => {
        port.postMessage({ key: MESSAGE_KEY.REFETCH });
      });

      socket.on(SOCKET_EVENT.UPDATE, (organizerInfo) => {
        port.postMessage({
          key: MESSAGE_KEY.UPDATE,
          payload: organizerInfo,
        });
      });
    </script>
  </body>
</html>
